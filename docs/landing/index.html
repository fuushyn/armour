<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PreHooks.ai ¬∑ The Firewall for AI Agents</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                    },
                    colors: {
                        bg: '#050505',
                        panel: '#0F0F0F',
                        border: '#222222',
                        accent: '#CCFF00', // Cyberpunk Volt
                        danger: '#FF3333',
                        dim: '#888888',
                        text: '#EEEEEE'
                    },
                }
            }
        }
    </script>
    <style>
        body { background-color: #050505; color: #EEE; }

        .snap-container {
            height: 100vh;
            height: 100dvh; /* Dynamic viewport height for mobile */
            overflow-y: scroll;
            scroll-snap-type: y proximity; /* Less aggressive snap */
            scroll-behavior: smooth;
        }

        @media (min-width: 768px) {
            body { overflow: hidden; }
            .snap-container {
                scroll-snap-type: y mandatory;
            }
        }

        .snap-section {
            min-height: 100vh;
            min-height: 100dvh;
            scroll-snap-align: start;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding-top: 80px; /* Account for fixed nav */
            padding-bottom: 20px;
        }

        @media (min-width: 768px) {
            .snap-section {
                padding-top: 0;
                padding-bottom: 0;
            }
        }

        .noise-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 50; opacity: 0.12;
            background-image: radial-gradient(circle at 50% 50%, transparent 0%, #050505 100%),
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; } 
        
        pre { background: transparent !important; margin: 0 !important; padding: 0 !important; text-shadow: none !important; white-space: pre-wrap; word-break: break-word; }
        code { font-family: 'Space Mono', monospace !important; font-size: 12px !important; }
        @media (min-width: 768px) {
            code { font-size: 13px !important; }
            pre { white-space: pre; }
        }
        
        .tab-active { border-bottom: 2px solid #CCFF00; color: #CCFF00; }
        .tab-inactive { border-bottom: 2px solid transparent; color: #888; }
        .tab-inactive:hover { color: #EEE; }

        .crt::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        .type-cursor::after {
            content: '‚ñà';
            animation: blink 1s step-start infinite;
            color: #CCFF00;
            margin-left: 2px;
        }
        @keyframes blink { 50% { opacity: 0; } } 
        
        .neon-text { text-shadow: 0 0 10px rgba(204, 255, 0, 0.5); }
        .neon-danger { text-shadow: 0 0 10px rgba(255, 51, 51, 0.5); }
    </style>
</head>
<body class="font-sans antialiased selection:bg-accent selection:text-black">

    <div class="noise-bg"></div>

    <!-- Nav -->
    <nav class="fixed top-0 w-full z-40 border-b border-white/5 bg-bg/80 backdrop-blur-xl">
        <div class="max-w-7xl mx-auto px-4 md:px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-3 h-3 bg-accent shadow-[0_0_10px_rgba(204,255,0,0.4)]"></div>
                <span class="font-mono font-bold text-lg md:text-xl tracking-tighter">PREHOOKS.AI</span>
            </div>
            <div class="flex items-center gap-4 md:gap-8">
                 <a href="https://x.com/heat_bender" target="_blank" class="text-[10px] md:text-xs font-mono text-dim hover:text-white transition-colors uppercase tracking-widest">Twitter</a>
                 <a href="https://www.linkedin.com/in/lakshya-gupta-0030771ba/" target="_blank" class="text-[10px] md:text-xs font-mono text-dim hover:text-white transition-colors uppercase tracking-widest hidden md:inline-block">LinkedIn</a>
                 <a href="https://github.com/fuushyn/armour" class="text-[10px] md:text-xs font-mono text-accent hover:text-white transition-colors uppercase tracking-widest font-bold">‚òÖ Star</a>
            </div>
        </div>
    </nav>

    <div class="snap-container">
        
        <!-- SECTION 1: HERO (Restored to Large) -->
        <section class="snap-section px-4 md:px-6">
            <div class="max-w-4xl mx-auto text-center">
                <div class="space-y-4 md:space-y-8">
                    <div class="inline-flex items-center gap-2 border border-white/10 bg-white/5 px-3 py-1 text-[9px] md:text-xs font-mono text-accent rounded-full mb-2">
                        <span class="w-1.5 h-1.5 rounded-full bg-accent animate-pulse"></span>
                        Community Defense Protocol
                    </div>

                    <h1 class="text-3xl md:text-7xl lg:text-8xl font-bold leading-[1.15] md:leading-[0.9] tracking-tight">
                        DON'T LET YOUR AI <br>
                        <span class="text-danger font-mono tracking-tighter">rm -rf /</span>
                    </h1>

                    <p class="text-xs md:text-lg lg:text-xl text-dim font-mono max-w-lg mx-auto leading-relaxed px-2">
                        PreHooks intercepts dangerous commands from Claude, Cursor, and Windsurf before they execute.
                    </p>

                    <!-- Install -->
                    <div class="flex flex-col items-center gap-4 pt-4 md:pt-8">
                        <div class="relative group cursor-pointer w-full max-w-xl" onclick="copyInstall()">
                            <div class="absolute -inset-0.5 bg-gradient-to-r from-accent/20 to-blue-500/20 rounded blur opacity-20 group-hover:opacity-40 transition duration-300"></div>
                            <div class="relative flex items-center justify-between bg-[#080808] border border-white/10 px-3 md:px-5 py-3 md:py-4 font-mono text-[11px] md:text-sm text-gray-300 hover:border-accent/50 transition-colors">
                                <div class="flex items-center gap-2 md:gap-3 overflow-hidden">
                                    <span class="text-accent">$</span>
                                    <span class="truncate">curl -fsSL prehooks.ai/install | bash</span>
                                </div>
                                <span class="text-[10px] md:text-xs text-dim group-hover:text-white uppercase tracking-wider pl-2 md:pl-4 whitespace-nowrap">Copy</span>
                            </div>
                        </div>
                    </div>

                    <!-- Live Stats -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 pt-6 md:pt-12 max-w-2xl mx-auto">
                        <div class="text-center">
                            <div class="font-mono text-xl md:text-3xl font-bold text-accent neon-text" id="stat-blocked">‚Äî</div>
                            <div class="font-mono text-[8px] md:text-[10px] text-dim uppercase tracking-widest mt-1">Threats Blocked</div>
                        </div>
                        <div class="text-center">
                            <div class="font-mono text-xl md:text-3xl font-bold text-text" id="stat-total">‚Äî</div>
                            <div class="font-mono text-[8px] md:text-[10px] text-dim uppercase tracking-widest mt-1">Calls Analyzed</div>
                        </div>
                        <div class="text-center">
                            <div class="font-mono text-xl md:text-3xl font-bold text-text" id="stat-latency">‚Äî</div>
                            <div class="font-mono text-[8px] md:text-[10px] text-dim uppercase tracking-widest mt-1">Avg Latency</div>
                        </div>
                        <div class="text-center">
                            <div class="font-mono text-xl md:text-3xl font-bold text-danger neon-danger" id="stat-rate">‚Äî</div>
                            <div class="font-mono text-[8px] md:text-[10px] text-dim uppercase tracking-widest mt-1">Block Rate</div>
                        </div>
                    </div>

                    <div class="pt-6 md:pt-12 animate-bounce opacity-30">
                        <p class="text-[9px] md:text-[10px] font-mono uppercase tracking-widest text-dim mb-2 text-center">Scroll to Initialize</p>
                        <svg width="16" height="16" class="md:w-5 md:h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-dim mx-auto"><path d="M7 13l5 5 5-5M7 6l5 5 5-5"/></svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: FULLSCREEN SCROLL-CONTROLLED TERMINAL (Restored to Immersive) -->
        <div id="terminal-scroll-container" class="h-[200vh] md:h-[400vh] relative z-20" style="scroll-snap-align: start;">
            <div class="sticky top-0 h-[100dvh] md:h-screen w-full overflow-hidden bg-[#020202] flex flex-col">
                
                <!-- Window Header (Full Width) -->
                <div class="flex items-center justify-between px-4 md:px-6 py-3 md:py-4 border-b border-white/5 bg-[#0A0A0A]">
                    <div class="flex gap-1.5 md:gap-2">
                        <div class="w-2 h-2 md:w-3 md:h-3 rounded-full bg-[#FF5F56]"></div>
                        <div class="w-2 h-2 md:w-3 md:h-3 rounded-full bg-[#FFBD2E]"></div>
                        <div class="w-2 h-2 md:w-3 md:h-3 rounded-full bg-[#27C93F]"></div>
                    </div>
                    <div class="font-mono text-[9px] md:text-xs text-dim uppercase tracking-wider md:tracking-[0.2em] truncate px-2">PREHOOKS SHELL v1.0.1</div>
                    <div class="flex gap-4">
                        <div class="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-accent animate-pulse shadow-[0_0_10px_rgba(204,255,0,0.4)]"></div>
                    </div>
                </div>

                <!-- Full Screen Terminal Body -->
                <div class="flex-grow p-4 md:p-10 lg:p-20 font-mono text-sm md:text-lg lg:text-2xl leading-relaxed overflow-hidden" id="demo-terminal">
                    <div class="text-dim mb-6 md:mb-12 flex items-center gap-2 md:gap-4">
                        <span class="opacity-50">#</span>
                        <span class="text-[10px] md:text-sm uppercase tracking-widest truncate">Connected to local node (darwin-arm64)</span>
                        <span class="h-[1px] flex-grow bg-white/5 hidden md:block"></span>
                    </div>
                    
                    <div id="terminal-lines" class="space-y-6">
                        <!-- Lines injected by scroll -->
                    </div>
                </div>

                <!-- Status Footer -->
                <div class="px-4 md:px-10 py-4 md:py-6 border-t border-white/5 bg-[#050505] flex justify-between items-center font-mono text-[9px] md:text-xs text-dim uppercase tracking-wider md:tracking-widest">
                    <div class="flex items-center gap-3 md:gap-6">
                        <div class="flex items-center gap-1 md:gap-2 text-accent">
                            <span>‚óè</span>
                            <span class="hidden xs:inline">PROTECTION</span> <span class="hidden md:inline">ACTIVE</span>
                        </div>
                        <span class="hidden md:inline">Latency: 1.2ms</span>
                    </div>
                    <div class="hidden md:block">TUNNEL: ESTABLISHED</div>
                </div>
            </div>
        </div>

        <!-- SECTION 3: VIRAL DATABASE (Restored to Large) -->
        <section class="snap-section bg-[#050505] py-10 md:py-20 px-4 md:px-6">
             <div class="w-full max-w-6xl mx-auto">
                <div class="text-center mb-8 md:mb-16">
                    <h2 class="text-3xl md:text-6xl font-bold mb-2 md:mb-4 tracking-tighter uppercase">The Blocklist</h2>
                    <p class="text-[10px] md:text-sm text-dim font-mono max-w-xl mx-auto uppercase tracking-widest md:tracking-[0.2em]">Community-sourced patterns of destruction.</p>
                </div>

                <div class="flex flex-col md:flex-row md:items-center justify-between mb-4 gap-3 md:gap-4">
                    <div class="flex gap-4 md:gap-10 font-mono text-[10px] md:text-sm overflow-x-auto pb-2 md:pb-0 whitespace-nowrap">
                        <button onclick="showTab('block')" id="btn-block" class="tab-active pb-2 transition-colors uppercase tracking-wider md:tracking-widest">Block</button>
                        <button onclick="showTab('allow')" id="btn-allow" class="tab-inactive pb-2 transition-colors uppercase tracking-wider md:tracking-widest">Allow</button>
                        <button onclick="showTab('prompt')" id="btn-prompt" class="tab-inactive pb-2 transition-colors uppercase tracking-wider md:tracking-widest">Prompt</button>
                    </div>

                    <a href="https://github.com/fuushyn/armour/issues/new" target="_blank" class="flex items-center justify-center gap-2 bg-accent text-black px-4 md:px-6 py-2 rounded font-bold font-mono hover:bg-white transition-colors text-[10px] md:text-xs uppercase w-full md:w-auto">
                        <span>+ ADD THREAT</span>
                    </a>
                </div>

                <div class="bg-[#0A0A0A] border border-white/10 rounded-none overflow-hidden shadow-2xl relative group crt h-[50vh] md:h-[60vh]">
                    <!-- Window Controls -->
                    <div class="flex items-center justify-between px-4 md:px-6 py-3 md:py-4 border-b border-white/5 bg-[#0F0F0F] relative z-10">
                        <div class="flex gap-1.5 md:gap-2">
                            <div class="w-2 h-2 md:w-3 md:h-3 rounded-full bg-white/10"></div>
                            <div class="w-2 h-2 md:w-3 md:h-3 rounded-full bg-white/10"></div>
                        </div>
                        <div class="font-mono text-[10px] md:text-xs text-dim uppercase tracking-wider md:tracking-widest truncate pl-2" id="filename-display">block-patterns.json</div>
                    </div>

                    <!-- Content -->
                    <div class="relative h-full">
                        <div id="content-block" class="p-4 md:p-8 h-full overflow-y-auto overflow-x-hidden text-left pb-20">
                            <pre><code class="language-json" id="code-block"></code></pre>
                        </div>
                        <div id="content-allow" class="p-4 md:p-8 h-full overflow-y-auto overflow-x-hidden text-left hidden pb-20">
                            <pre><code class="language-json" id="code-allow"></code></pre>
                        </div>
                        <div id="content-prompt" class="p-4 md:p-8 h-full overflow-y-auto overflow-x-hidden text-left hidden pb-20">
                            <pre><code class="language-markdown" id="code-prompt"></code></pre>
                        </div>
                        
                        <!-- Fade overlay -->
                        <div class="absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-[#0A0A0A] to-transparent pointer-events-none"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: FINAL CTA (Scaled Down & Refined) -->
        <section class="snap-section bg-[#020202] px-4 md:px-6">
            <div class="max-w-4xl mx-auto text-center space-y-6 md:space-y-10">
                <div class="space-y-3 md:space-y-4">
                    <h2 class="text-2xl md:text-5xl font-bold tracking-tighter uppercase">Secure the Future</h2>
                    <p class="text-dim font-mono text-[10px] md:text-sm max-w-lg mx-auto px-4">
                        PreHooks is an open-source movement to keep AI agents safe. Help us reach more developers.
                    </p>
                </div>

                <div class="flex flex-col items-center gap-6 md:gap-8">
                    <a href="https://github.com/fuushyn/armour" target="_blank" class="group relative inline-block">
                        <div class="absolute -inset-1 bg-accent rounded blur opacity-20 group-hover:opacity-100 transition duration-500"></div>
                        <div class="relative bg-accent text-black px-6 py-4 md:px-12 md:py-6 font-mono text-sm md:text-xl font-black uppercase tracking-tighter flex items-center gap-2 md:gap-3 hover:bg-white transition-colors">
                            <span>Star on GitHub</span>
                            <svg width="20" height="20" class="md:w-6 md:h-6" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"/></svg>
                        </div>
                    </a>

                    <div class="flex gap-6 md:gap-10 pt-6 md:pt-8 border-t border-white/5 w-full justify-center">
                        <a href="https://x.com/heat_bender" target="_blank" class="text-dim hover:text-white font-mono text-[9px] md:text-xs tracking-widest uppercase transition-colors">Twitter / X</a>
                        <a href="https://www.linkedin.com/in/lakshya-gupta-0030771ba/" target="_blank" class="text-dim hover:text-white font-mono text-[9px] md:text-xs tracking-widest uppercase transition-colors">LinkedIn</a>
                    </div>
                </div>

                <footer class="pt-8 md:pt-16 text-[7px] md:text-[8px] text-white/5 font-mono uppercase tracking-[0.2em] md:tracking-[0.4em]">
                    <div>PREHOOKS.AI ‚Äî 2026 ‚Äî @HEAT_BENDER</div>
                </footer>
            </div>
        </section>

    </div>

    <script>
        // --- Fetch all data from GitHub via worker proxy ---
        async function loadPatterns() {
            try {
                const [blockRes, allowRes, promptRes] = await Promise.all([
                    fetch('/block-patterns.json'),
                    fetch('/allow-patterns.json'),
                    fetch('/prompt.txt')
                ]);

                const blockPatterns = await blockRes.json();
                const allowPatterns = await allowRes.json();
                const promptText = await promptRes.text();

                document.getElementById('code-block').textContent = JSON.stringify(blockPatterns, null, 2);
                document.getElementById('code-allow').textContent = JSON.stringify(allowPatterns, null, 2);
                document.getElementById('code-prompt').textContent = promptText;
                Prism.highlightAll();
            } catch (err) {
                console.error('Failed to load patterns:', err);
                document.getElementById('code-block').textContent = 'Failed to load';
                document.getElementById('code-allow').textContent = 'Failed to load';
                document.getElementById('code-prompt').textContent = 'Failed to load';
            }
        }

        loadPatterns();

        // --- Tabs ---
        function showTab(tab) {
            ['block', 'allow', 'prompt'].forEach(t => {
                document.getElementById('content-' + t).classList.add('hidden');
                document.getElementById('btn-' + t).className = 'tab-inactive pb-2 transition-colors uppercase tracking-widest';
            });
            document.getElementById('content-' + tab).classList.remove('hidden');
            document.getElementById('btn-' + tab).className = 'tab-active pb-2 transition-colors uppercase tracking-widest';
            
            const names = {'block': 'block-patterns.json', 'allow': 'allow-patterns.json', 'prompt': 'safety-prompt.txt'};
            document.getElementById('filename-display').textContent = names[tab];
        }

        function copyInstall() {
            const cmd = 'curl -fsSL https://prehooks.ai/install | bash';
            navigator.clipboard.writeText(cmd).then(() => {
                const toast = document.createElement('div');
                toast.className = 'fixed bottom-8 left-1/2 -translate-x-1/2 bg-accent text-black px-6 py-3 font-mono text-sm font-bold z-50 shadow-lg';
                toast.textContent = 'Copied to clipboard';
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 2000);
            });
        }

        // --- SCROLL INTERACTION LOGIC ---
        const snapContainer = document.querySelector('.snap-container');
        const terminalContainer = document.getElementById('terminal-scroll-container');
        const linesContainer = document.getElementById('terminal-lines');

        const scrollSequence = [
            { html: '<span class="text-white">claude-agent --task \"cleanup project\"</span>', prompt: true },
            { html: '<span class="text-dim">Analyzing project structure...</span>' },
            { html: '<span class="text-yellow-500">Warning: Low disk space detected.</span>' },
            { html: '<span class="text-dim">Attempting to free space...</span>' },
            { html: '<span class="text-white">rm -rf /tmp/*</span>', prompt: true },
            { html: '<span class="text-green-500">Executed successfully.</span>' },
            { html: '<span class="text-white neon-text">rm -rf /</span>', prompt: true },
            { html: '<span class="text-danger font-bold bg-danger/10 px-3 py-2 inline-block rounded-none border border-danger/30 uppercase tracking-[0.2em] text-xs md:text-xl">üö´ BLOCKED BY PREHOOKS</span>' },
            { html: '<span class="text-danger font-bold text-xs md:text-xl">CRITICAL SECURITY ALERT: RECURSIVE DELETION DETECTED.</span>' },
            { html: '<span class="text-danger text-xs md:text-lg">Prevention protocol engaged. Session terminated.</span>' }
        ];

        function updateTerminal() {
            const containerRect = terminalContainer.getBoundingClientRect();
            const containerHeight = terminalContainer.offsetHeight;
            const windowHeight = window.innerHeight;

            const endY = containerHeight - windowHeight;
            const currentY = -containerRect.top;

            let progress = Math.max(0, Math.min(1, currentY / endY));

            const linesToShow = Math.floor(progress * (scrollSequence.length + 1));

            let html = '';
            for (let i = 0; i < scrollSequence.length; i++) {
                if (i < linesToShow) {
                    const line = scrollSequence[i];
                    html += `<div class="opacity-100 transition-opacity duration-300">`;
                    if (line.prompt) html += `<span class="text-accent mr-2 md:mr-4">‚ûú</span>`;
                    html += line.html + `</div>`;
                }
            }

            if (linesToShow <= scrollSequence.length) {
                html += `<div><span class="text-accent mr-2 md:mr-4">‚ûú</span><span class="type-cursor"></span></div>`;
            }

            linesContainer.innerHTML = html;
        }

        // Listen to scroll on the snap container, not window
        snapContainer.addEventListener('scroll', updateTerminal);
        // Also trigger on load
        updateTerminal();

        // --- Live Stats ---
        async function loadStats() {
            try {
                const res = await fetch('https://clawdguard.prehooks.workers.dev/stats');
                const data = await res.json();
                document.getElementById('stat-blocked').textContent = data.blocked.toLocaleString();
                document.getElementById('stat-total').textContent = data.total.toLocaleString();
                document.getElementById('stat-latency').textContent = data.latency.avg + 'ms';
                const rate = data.total > 0 ? ((data.blocked / data.total) * 100).toFixed(1) : '0';
                document.getElementById('stat-rate').textContent = rate + '%';
            } catch (e) {
                console.error('Stats fetch failed:', e);
            }
        }
        loadStats();
        setInterval(loadStats, 30000);
    </script>
</body>
</html>